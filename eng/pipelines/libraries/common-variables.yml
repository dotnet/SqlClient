#################################################################################
# Licensed to the .NET Foundation under one or more agreements.                 #
# The .NET Foundation licenses this file to you under the MIT license.          #
# See the LICENSE file in the project root for more information.                #
#################################################################################

# This file is only included in Abstractions, Azure, and MDS OneBranch Official
# pipelines.

variables:
  - group: ESRP Federated Creds (AME)
    # ESRPConnectedServiceName
    # ESRPClientId
    # AppRegistrationClientId
    # AppRegistrationTenantId
    # AuthAKVName
    # AuthSignCertName

  - name: CommitHead
    value: '' # the value will be extracted from the repo's head
  - name: REPOROOT
    value: $(Build.SourcesDirectory)
  - name: softwareFolder
    value: $(REPOROOT)/software
  - name: symbolsFolder
    value: $(REPOROOT)/symbols
  - name: artifactDirectory
    value: '$(REPOROOT)/packages'

  # C# assembly versions must be in the format: Major.Minor.Build.Revision, but
  # $(Build.BuildNumber) has the format XXX.YY.  Additionally, each version part
  # must be a positive 16-bit integer less than 65535.  Simply concatenating
  # both parts of $(Build.BuildNumber) could produce values larger than 65534,
  # so we must omit the second part entirely.  Unfortunately, this may result
  # in multiple subsequent pipline builds using the same C# assembly versions.
  # The package versions will not be affected and will show the complete
  # $(Build.BuildNumber) values.
  - name: assemblyBuildNumber
    value: $[ split(variables['Build.BuildNumber'], '.')[0] ]

  # ----------------------------------------------------------------------------
  # Abstractions Package Versions
  #
  # These are version values that will be used by the official build.  They
  # should be updated after each release to reflect the next release's versions.

  # The NuGet package version for GA releases (non-preview).
  - name: abstractionsPackageVersion
    value: '1.0.0'

  # The NuGet package version for preview releases.
  - name: abstractionsPackagePreviewVersion
    value: 1.0.0-preview1.$(Build.BuildNumber)

  # The AssemblyFileVersion for all assemblies in the Abstractions package.
  - name: abstractionsAssemblyFileVersion
    value: 1.0.0.$(assemblyBuildNumber)

  # ----------------------------------------------------------------------------
  # MDS Package Versions
  #
  # These are version values that will be used by the official build.  They
  # should be updated after each release to reflect the next release's versions.

  # The NuGet package version for GA releases (non-preview).
  - name: mdsPackageVersion
    value: '7.0.0'

  # The NuGet package version for preview releases.
  - name: previewMdsPackageVersion
    value: 7.0.0-preview4

  # The AssemblyFileVersion for all assemblies in the MDS package.
  - name: mdsAssemblyFileVersion
    value: 7.0.0.$(assemblyBuildNumber)

  # The path to the NuGet packaging specification file used to generate the MDS NuGet package.
  - name: nuspecPath
    value: '$(REPOROOT)/tools/specs/Microsoft.Data.SqlClient.nuspec'

  # ----------------------------------------------------------------------------
  # Azure Package Versions
  #
  # These are version values that will be used by the official build.  They
  # should be updated after each release to reflect the next release's versions.

  # The NuGet package version for GA releases (non-preview).
  - name: azurePackageVersion
    value: '1.0.0'

  # The NuGet package version for preview releases.
  - name: azurePackagePreviewVersion
    value: 1.0.0-preview1.$(Build.BuildNumber)

  # The AssemblyFileVersion for all assemblies in the Azure package.
  - name: azureAssemblyFileVersion
    value: 1.0.0.$(assemblyBuildNumber)
