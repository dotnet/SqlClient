#################################################################################
# Licensed to the .NET Foundation under one or more agreements.                 #
# The .NET Foundation licenses this file to you under the MIT license.          #
# See the LICENSE file in the project root for more information.                #
#################################################################################

variables:
  - group: ESRP Federated Creds (AME)
    # ESRPConnectedServiceName
    # ESRPClientId
    # AppRegistrationClientId
    # AppRegistrationTenantId
    # AuthAKVName
    # AuthSignCertName

  - name: Configuration
    value: Release
  - name: CommitHead
    value: '' # the value will be extracted from the repo's head  
  - name: REPOROOT
    value: $(Build.SourcesDirectory)
  - name: softwareFolder
    value: $(REPOROOT)/software
  - name: symbolsFolder
    value: $(REPOROOT)/symbols
  - name: artifactDirectory
    value: '$(REPOROOT)/packages'

  # C# assembly versions must be in the format: Major.Minor.Build.Revision, but
  # $(Build.BuildNumber) has the format XXX.YY, so we must omit the dot.  This
  # perturbs the build number and could cause duplicates if Azure Pipelines
  # changes how $(Build.BuildNumber) is formatted in the future, but it's the
  # best we can do without producing an invalid version number.
  - name: assemblyBuildNumber
    value: $[ replace(variables['Build.BuildNumber'], '.', '') ]
  
  # ----------------------------------------------------------------------------
  # Abstractions Package Versions
  #
  # These are version values that will be used by the official build.  They
  # should be updated after each release to reflect the next release's versions.

  # The NuGet package version for GA releases (non-preview).
  - name: abstractionsPackageVersion
    value: '1.0.0'
  
  # The NuGet package version for preview releases.
  - name: abstractionsPackagePreviewVersion
    value: 1.0.0-preview1.$(Build.BuildNumber)

  # The AssemblyFileVersion for all assemblies in the Abstractions package.
  #
  - name: abstractionsAssemblyFileVersion
    value: 1.0.0.$(assemblyBuildNumber)

  # Update this after every release. This is used to generate the MDS NuGet package version.
  - name: Major
    value: '7'
  - name: Minor
    value: '0'
  - name: Patch
    value: '0'

    # Update this for preview releases.
  - name: Preview
    value: '-preview'
  - name: Revision
    value: '1'

  - name: mdsPackageVersion
    value: $(Major).$(Minor).$(Patch)
  - name: previewMdsPackageVersion
    value: $(Major).$(Minor).$(Patch)$(Preview)$(Revision).$(Build.BuildNumber)
  - name: mdsAssemblyFileVersion
    value: $(Major).$(Minor).$(Patch).$(assemblyBuildNumber)
  - name: nuspecPath
    value: '$(REPOROOT)/tools/specs/Microsoft.Data.SqlClient.nuspec'
