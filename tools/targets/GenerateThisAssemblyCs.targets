<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Target Name="GenerateThisAssemblyCs"
          BeforeTargets="CoreCompile">

    <PropertyGroup>

      <!-- Put the ThisAssembly class in the System namespace by default. -->
      <ThisAssemblyNamespace Condition="'$(ThisAssemblyNamespace)' == ''">System</ThisAssemblyNamespace>

      <ThisAssemblyCsContents>
namespace $(ThisAssemblyNamespace)
{
    internal static class ThisAssembly
    {
        internal const string InformationalVersion = "$(AssemblyFileVersion)"%3B
        internal const string NuGetPackageVersion = "$(Version)"%3B
    }
}
      </ThisAssemblyCsContents>
    </PropertyGroup>

    <!-- Unconditionally write the ThisAssembly.cs file. -->
    <WriteLinesToFile
      File="$(IntermediateOutputPath)/ThisAssembly.cs"
      Lines="$(ThisAssemblyCsContents)"
      Overwrite="true"
      Encoding="Unicode"/>

  </Target>

  <!-- Ensure the generated ThisAssembly.cs is included in the compilation. -->
  <ItemGroup>
    <Compile Include="$(IntermediateOutputPath)/ThisAssembly.cs"/>
  </ItemGroup>
</Project>
