# Release Notes

## [Stable release 6.0.4] - 2025-11-14

This update brings the below changes over the previous stable release:

### Added

#### App Context Switch for Ignoring Server-Provided Failover Partner

*What Changed:*

- A new app context switch `Switch.Microsoft.Data.SqlClient.IgnoreServerProvidedFailoverPartner` was introduced to let the client ignore server-provided failover partner info in Basic Availability Groups (BAGs). When the switch is enabled, only the failover partner specified in the connection string is used; server-supplied partner values are skipped. This context switch was introduced in PR [#3703](https://github.com/dotnet/SqlClient/pull/3703).

*Who Benefits:*

- Applications connecting to SQL Server BAGs using TCP and custom ports, especially where the server's provided partner name lacks the protocol, host, or port. This avoids connection failures when the server-provided partner is incompatible or incomplete.
- Teams who manage availability groups and rely on client-side control of failover behavior in heterogeneous networking environments.

*Impact:*

- If your environment might be affected (i.e., you operate a BAG with custom ports, or have experienced failures after failover), you can enable the new switch in your application:

```c#
AppContext.SetSwitch("Switch.Microsoft.Data.SqlClient.IgnoreServerProvidedFailoverPartner", true);
```

- Then, ensure your connection string includes your preferred failover partner (with correct `tcp:host,port`) so that the client uses that instead of the server's suggestion.
- Without enabling this, by default, the client continues to prefer the server-provided partner, maintaining backwards compatibility.

## Target Platform Support

- .NET Framework 4.6.2+ (Windows ARM64, Windows x64, Windows x86)
- .NET 8.0+ (Linux, macOS, Windows ARM64, Windows x64, Windows x86)

### Dependencies

#### .NET Framework

- Azure.Identity 1.14.2
- Microsoft.Bcl.Cryptography 8.0.0
- Microsoft.Data.SqlClient.SNI 6.0.2
- Microsoft.Extensions.Caching.Memory 8.0.1
- Microsoft.IdentityModel.JsonWebTokens 7.5.0
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.5.0
- System.Buffers 4.5.1
- System.Security.Cryptography.Pkcs 8.0.1
- System.Text.Encodings.Web 8.0.0
- System.Text.Json 8.0.5
- System.Data.Common 4.3.0

#### .NET 8

- Azure.Identity 1.14.2
- Microsoft.Bcl.Cryptography 8.0.0
- Microsoft.Data.SqlClient.SNI.runtime 6.0.2
- Microsoft.Extensions.Caching.Memory 8.0.1
- Microsoft.IdentityModel.JsonWebTokens 7.5.0
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.5.0
- Microsoft.SqlServer.Server 1.0.0
- System.Configuration.ConfigurationManager 8.0.1
- System.Security.Cryptography.Pkcs 8.0.1

#### .NET 9

- Azure.Identity 1.14.2
- Microsoft.Bcl.Cryptography 9.0.4
- Microsoft.Data.SqlClient.SNI.runtime 6.0.2
- Microsoft.Extensions.Caching.Memory 9.0.4
- Microsoft.IdentityModel.JsonWebTokens 7.5.0
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.5.0
- Microsoft.SqlServer.Server 1.0.0
- System.Configuration.ConfigurationManager 9.0.4
- System.Security.Cryptography.Pkcs 9.0.4
- System.Text.Json 9.0.5
