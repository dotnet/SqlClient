# Release Notes

## Stable Release 6.1.4 - 2026-01-15

This update brings the following changes since the [6.1.3](6.1.3.md) release:

### Fixed

- Fixed NullReferenceException issue with `SqlDataAdapter` when processing batch scenarios where certain SQL RPC calls may not include system parameters.
  ([#3877](https://github.com/dotnet/SqlClient/pull/3877))
- Fixed connection pooling issue where extra connection deactivation was causing active connection counts to go negative.
  ([#3776](https://github.com/dotnet/SqlClient/pull/3776))

### Added

#### AppContext Switch for enabling MultiSubnetFailover

*What Changed:*

- Added new AppContext switch `Switch.Microsoft.Data.SqlClient.EnableMultiSubnetFailoverByDefault` to set `MultiSubnetFailover=true` by default in connection string.
  ([#3851](https://github.com/dotnet/SqlClient/pull/3851))

*Who Benefits:*

- Applications that need MultiSubnetFailover enabled globally without modifying connection strings.

*Impact:*

- Applications can now enable MultiSubnetFailover globally using one of the following methods:

```c#
// In application code
AppContext.SetSwitch("Switch.Microsoft.Data.SqlClient.EnableMultiSubnetFailoverByDefault", true);
```

```json
// In runtimeconfig.json
{
  "configProperties": {
    "Switch.Microsoft.Data.SqlClient.EnableMultiSubnetFailoverByDefault": true
  }
}
```

```xml
<!-- In App.Config -->
<runtime>
  <AppContextSwitchOverrides value="Switch.Microsoft.Data.SqlClient.EnableMultiSubnetFailoverByDefault=true" />
</runtime>
```

### Changed

- Optimized `SqlStatistics` execution timing by using `Environment.TickCount` instead of more expensive timing mechanisms.
  ([#3830](https://github.com/dotnet/SqlClient/pull/3830))
- Updated dependencies ([#3843](https://github.com/dotnet/SqlClient/pull/3843)):
  - .NET Framework 4.6.2:
    - Azure.Core 1.47.1 -> 1.50.0
    - Azure.Identity 1.14.2 -> 1.17.1
    - Microsoft.Identity.Client 4.80.0 - Added
    - System.Buffers 4.5.1 -> 4.6.1
    - System.Diagnostics.DiagnosticSource 8.0.1 - Added
    - System.IdentityModel.Tokens.Jwt 7.7.1 - Added
    - System.Memory 4.6.3 - Added
    - System.Text.Json 8.0.5 -> 8.0.6
    - System.Text.RegularExpressions 4.3.1 - Added
    - Microsoft.Bcl.Cryptography - Removed
    - System.Text.Encodings.Web - Removed
  - .NET 8.0:
    - Azure.Core 1.47.1 -> 1.50.0
    - Azure.Identity 1.14.2 -> 1.17.1
    - Microsoft.Identity.Client 4.80.0 - Added
    - System.Diagnostics.DiagnosticSource 8.0.1 - Added
    - System.IdentityModel.Tokens.Jwt 7.7.1 - Added
    - Microsoft.Bcl.Cryptography - Removed
    - System.Text.Json - Removed
  - .NET 9.0:
    - Azure.Core 1.47.1 -> 1.50.0
    - Azure.Identity 1.14.2 -> 1.17.1
    - Microsoft.Extensions.Caching.Memory 9.0.4 -> 9.0.11
    - Microsoft.Identity.Client 4.80.0 - Added
    - System.Configuration.ConfigurationManager 9.0.4 -> 9.0.11
    - System.Diagnostics.DiagnosticSource 9.0.11 - Added
    - System.IdentityModel.Tokens.Jwt 7.7.1 - Added
    - System.Security.Cryptography.Pkcs 9.0.4 -> 9.0.11
    - Microsoft.Bcl.Cryptography - Removed
    - System.Text.Json - Removed
  - .NET Standard 2.0:
    - Azure.Core 1.47.1 -> 1.50.0
    - Azure.Identity 1.14.2 -> 1.17.1
    - Microsoft.Extensions.Caching.Memory 9.0.4 -> 8.0.1
    - Microsoft.Identity.Client 4.80.0 - Added
    - System.Configuration.ConfigurationManager 9.0.4 -> 8.0.1
    - System.Diagnostics.DiagnosticSource 8.0.1 - Added
    - System.IdentityModel.Tokens.Jwt 7.7.1 - Added
    - System.Security.Cryptography.Pkcs 9.0.4 -> 8.0.1
    - System.Text.Json 9.0.5 -> 8.0.6
    - Microsoft.Bcl.Cryptography - Removed

## Target Platform Support

- .NET Framework 4.6.2+ (Windows x86, Windows x64)
- .NET 8.0+ (Windows x86, Windows x64, Windows ARM64, Linux, macOS)
- .NET Standard 2.0+ (Windows x86, Windows x64, Windows ARM64, Linux, macOS)

### Dependencies

#### .NET Framework 4.6.2

- Azure.Core 1.50.0
- Azure.Identity 1.17.1
- Microsoft.Data.SqlClient.SNI 6.0.2
- Microsoft.Extensions.Caching.Memory 8.0.1
- Microsoft.Identity.Client 4.80.0
- Microsoft.IdentityModel.JsonWebTokens 7.7.1
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.7.1
- System.Buffers 4.6.1
- System.Data.Common 4.3.0
- System.Diagnostics.DiagnosticSource 8.0.1
- System.IdentityModel.Tokens.Jwt 7.7.1
- System.Memory 4.6.3
- System.Security.Cryptography.Pkcs 8.0.1
- System.Text.Json 8.0.6
- System.Text.RegularExpressions 4.3.1

#### .NET 8.0

- Azure.Core 1.50.0
- Azure.Identity 1.17.1
- Microsoft.Data.SqlClient.SNI.runtime 6.0.2
- Microsoft.Extensions.Caching.Memory 8.0.1
- Microsoft.Identity.Client 4.80.0
- Microsoft.IdentityModel.JsonWebTokens 7.7.1
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.7.1
- Microsoft.SqlServer.Server 1.0.0
- System.Configuration.ConfigurationManager 8.0.1
- System.Diagnostics.DiagnosticSource 8.0.1
- System.IdentityModel.Tokens.Jwt 7.7.1
- System.Security.Cryptography.Pkcs 8.0.1

#### .NET 9.0

- Azure.Core 1.50.0
- Azure.Identity 1.17.1
- Microsoft.Data.SqlClient.SNI.runtime 6.0.2
- Microsoft.Extensions.Caching.Memory 9.0.11
- Microsoft.Identity.Client 4.80.0
- Microsoft.IdentityModel.JsonWebTokens 7.7.1
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.7.1
- Microsoft.SqlServer.Server 1.0.0
- System.Configuration.ConfigurationManager 9.0.11
- System.Diagnostics.DiagnosticSource 9.0.11
- System.IdentityModel.Tokens.Jwt 7.7.1
- System.Security.Cryptography.Pkcs 9.0.11

#### .NET Standard 2.0

- Azure.Core 1.50.0
- Azure.Identity 1.17.1
- Microsoft.Data.SqlClient.SNI.runtime 6.0.2
- Microsoft.Extensions.Caching.Memory 8.0.1
- Microsoft.Identity.Client 4.80.0
- Microsoft.IdentityModel.JsonWebTokens 7.7.1
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.7.1
- Microsoft.SqlServer.Server 1.0.0
- System.Configuration.ConfigurationManager 8.0.1
- System.Diagnostics.DiagnosticSource 8.0.1
- System.IdentityModel.Tokens.Jwt 7.7.1
- System.Security.Cryptography.Pkcs 8.0.1
- System.Text.Json 8.0.6
