<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk">

  <!--
    Additional project config is imported from parent Directory.Build.props
    files.
  -->

  <!-- Versioning Properties -->
  <PropertyGroup>
    <!-- The current Major version number for the Abstractions package. -->
    <AbstractionsPackageMajorVersion>1</AbstractionsPackageMajorVersion>

    <!--
      If the Abstractions package version is specified on the command-line, then
      we use it as-is, for example:

        msbuild -p:AbstractionsPackageVersion=1.0.0
        dotnet build -p:AbstractionsPackageVersion=1.0.0

      Otherwise, we use a default value with a "-dev" suffix.

      $(BuildNumber) is defined in tools/props/Versions.props.
    -->
    <AbstractionsPackageVersionSuffix Condition="'$(AbstractionsPackageVersion)' == ''">-dev</AbstractionsPackageVersionSuffix>
    <AbstractionsPackageVersion>$(AbstractionsPackageMajorVersion).0.0.$(BuildNumber)</AbstractionsPackageVersion>

    <!--
      We pin the AssemblyVersion of our package to its current Major version
      number, with all remaining parts set to 0.
    -->
    <AbstractionsPackageAssemblyVersion>$(AbstractionsPackageMajorVersion).0.0.0</AbstractionsPackageAssemblyVersion>
  </PropertyGroup>

  <!-- Target Config -->
  <PropertyGroup>
    <TargetFrameworks>netstandard2.0</TargetFrameworks>
  </PropertyGroup>

  <!-- Compiler Config -->
  <PropertyGroup>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

  <!-- Build Config -->
  <PropertyGroup>
    <AssemblyName>Microsoft.Data.SqlClient.Extensions.Abstractions</AssemblyName>
    <RootNamespace>Microsoft.Data.SqlClient.Extensions.Abstractions</RootNamespace>

    <AssemblyVersion>$(AbstractionsPackageAssemblyVersion)</AssemblyVersion>
    <AssemblyFileVersion>$(AbstractionsPackageVersion)</AssemblyFileVersion>
    <FileVersion>$(AssemblyFileVersion)</FileVersion>
    <Version>$(AbstractionsPackageVersion)$(AbstractionsPackageVersionSuffix)</Version>
  </PropertyGroup>
  <ItemGroup>
    <!-- Our API is CLS Compliant. -->
    <AssemblyAttribute Include="System.CLSCompliantAttribute">
      <_Parameter1>true</_Parameter1>
    </AssemblyAttribute>

    <!-- Our unit tests have access to our internal types. -->
    <InternalsVisibleTo Include="Microsoft.Data.SqlClient.Extensions.Abstractions.Test" />
  </ItemGroup>

  <!--
    NuGet Package Config

    See: https://learn.microsoft.com/en-us/nuget/reference/msbuild-targets#pack-target
  -->
  <PropertyGroup>
    <!--
      We omit specifying <PackageId> here since it defaults to $(AssemblyName),
      specified above.
    -->

    <PackageVersion>$(Version)</PackageVersion>
    <PackageOutputPath>$(PackagesDir)</PackageOutputPath>
    <IncludeSymbols>true</IncludeSymbols>
    <SymbolPackageFormat>snupkg</SymbolPackageFormat>

    <!--
      The parent Directory.Build.props file unilaterally adds '.pdb' to the
      file types that are included in application packages.  We don't want this
      behaviour, so we must reset this NuGet property to its original value.
    -->
    <AllowedOutputExtensionsInPackageBuildOutputFolder>$(OriginalAllowedOutputExtensions)</AllowedOutputExtensionsInPackageBuildOutputFolder>
    
    <Authors>Microsoft Corporation</Authors>
    <Company>Microsoft Corporation</Company>
    <Description>Microsoft.Data.SqlClient Extensions Abstractions</Description>
    <RepositoryUrl>https://github.com/dotnet/SqlClient</RepositoryUrl>
    <PackageLicenseExpression>MIT</PackageLicenseExpression>
    <PackageIcon>dotnet.png</PackageIcon>
  </PropertyGroup>
  <ItemGroup>
    <None Include="../../../../tools/icons/dotnet.png" Pack="true" PackagePath="/" />
  </ItemGroup>

</Project>
