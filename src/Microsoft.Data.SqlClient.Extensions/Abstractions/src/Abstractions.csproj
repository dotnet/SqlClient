<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk">

  <!--
    Additional project config is imported from parent Directory.Build.props
    files.
  -->

  <!-- Versioning Properties -->
  <PropertyGroup>
    <!-- The current Major version number for the Abstractions package. -->
    <AbstractionsPackageMajorVersion>1</AbstractionsPackageMajorVersion>

    <!--
      The default Abstractions package version.  This may be overridden by
      specifying a value on the command-line:

        msbuild -p:AbstractionsPackageVersion=1.0.0
        dotnet build -p:AbstractionsPackageVersion=1.0.0
    -->
    <AbstractionsPackageVersion>$(AbstractionsPackageMajorVersion).0.0</AbstractionsPackageVersion>

    <!--
      If the $(BuildNumber) property is defined, append it as the fourth part
      of the version number (the revision part).
    -->
    <AbstractionsPackageVersion Condition="'$(BuildNumber)' != ''">$(AbstractionsPackageVersion).$(BuildNumber)</AbstractionsPackageVersion>

    <!--
      We pin the AssemblyVersion of our package to its current Major version
      number, with all remaining parts set to 0.
    -->
    <AbstractionsPackageAssemblyVersion>$(AbstractionsPackageMajorVersion).0.0.0</AbstractionsPackageAssemblyVersion>
  </PropertyGroup>

  <!-- Target Config -->
  <PropertyGroup>
    <TargetFrameworks>netstandard2.0</TargetFrameworks>
  </PropertyGroup>

  <!-- Compiler Config -->
  <PropertyGroup>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

  <!-- Build Config -->
  <PropertyGroup>
    <AssemblyName>Microsoft.Data.SqlClient.Extensions.Abstractions</AssemblyName>
    <!--
      We use the AbstractionsPackageVersion supplied via a command-line
      property, or the default from Versions.props.
    -->
    <PackageVersion>$(AbstractionsPackageVersion)</PackageVersion>
    <AssemblyVersion>$(AbstractionsPackageAssemblyVersion)</AssemblyVersion>
    <AssemblyFileVersion>$(PackageVersion)</AssemblyFileVersion>
    <FileVersion>$(AssemblyFileVersion)</FileVersion>

    <RootNamespace>Microsoft.Data.SqlClient.Extensions.Abstractions</RootNamespace>
  </PropertyGroup>
  <ItemGroup>
    <!-- Our API is CLS Compliant. -->
    <AssemblyAttribute Include="System.CLSCompliantAttribute">
      <_Parameter1>true</_Parameter1>
    </AssemblyAttribute>

    <!-- Our unit tests have access to our internal types. -->
    <InternalsVisibleTo Include="Microsoft.Data.SqlClient.Extensions.Abstractions.Test" />
  </ItemGroup>

  <!--
    NuGet Package Config

    See: https://learn.microsoft.com/en-us/nuget/reference/msbuild-targets#pack-target
  -->
  <PropertyGroup>
    <!--
      We omit specifying <PackageId> here since it defaults to $(AssemblyName),
      specified above.
    -->

    <!--
      We omit specifying <PackageVersion> here since it has already been
      defined above as a configurable property.
    -->

    <PackageOutputPath>$(PackagesDir)</PackageOutputPath>
    <IncludeSymbols>true</IncludeSymbols>
    <SymbolPackageFormat>snupkg</SymbolPackageFormat>

    <!--
      The parent Directory.Build.props file unilaterally adds '.pdb' to the
      file types that are included in application packages.  We don't want this
      behaviour, so we must reset this NuGet property to its original value.
    -->
    <AllowedOutputExtensionsInPackageBuildOutputFolder>$(OriginalAllowedOutputExtensions)</AllowedOutputExtensionsInPackageBuildOutputFolder>
    
    <Authors>Microsoft Corporation</Authors>
    <Company>Microsoft Corporation</Company>
    <Description>Microsoft.Data.SqlClient Extensions Abstractions</Description>
    <RepositoryUrl>https://github.com/dotnet/SqlClient</RepositoryUrl>
    <PackageLicenseExpression>MIT</PackageLicenseExpression>
    <PackageIcon>dotnet.png</PackageIcon>
  </PropertyGroup>
  <ItemGroup>
    <None Include="../../../../tools/icons/dotnet.png" Pack="true" PackagePath="/" />
  </ItemGroup>

</Project>
