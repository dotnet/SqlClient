<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="Current" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  
  <!-- Import the closest parent Directory.build.props, wherever it happens to be. -->
  <Import Project="$([MSBuild]::GetPathOfFileAbove('Directory.Build.props', '$(MSBuildThisFileDirectory)../'))" />
  
  <PropertyGroup>
    <AllowedOutputExtensionsInPackageBuildOutputFolder>$(AllowedOutputExtensionsInPackageBuildOutputFolder);.pdb</AllowedOutputExtensionsInPackageBuildOutputFolder>
    <ContinuousIntegrationBuild>true</ContinuousIntegrationBuild>
    <TargetFrameworkMonikerAssemblyAttributesPath>$([System.IO.Path]::Combine('$(IntermediateOutputPath)','$(TargetFramework)','$(TargetFrameworkMoniker).AssemblyAttributes$(DefaultLanguageSourceExtension)'))</TargetFrameworkMonikerAssemblyAttributesPath>
  </PropertyGroup>

  <ItemGroup>
    <EmbeddedFiles Include="$(GeneratedAssemblyInfoFile)"/>
  </ItemGroup>

  <PropertyGroup>
    <NetFxTargets>net462</NetFxTargets>
    <NetTargets>net8.0;net9.0</NetTargets>
  </PropertyGroup>

  <Choose>
    <!-- If the $TF property is set, use it as the target frameworks. -->
    <When Condition="'$(TF)' != ''">
      <PropertyGroup>
        <TargetFrameworks>$(TF)</TargetFrameworks>
      </PropertyGroup>
    </When>
    <!--
      When building via build.proj, the build targets imply either .NET or .NET
      Framework (never both), so restrict the target frameworks accordingly.
    -->
    <When Condition="'$(BuildProj)' == 'true'">
      <PropertyGroup>
        <TargetFrameworks>$(NetTargets)</TargetFrameworks>
        <TargetFrameworks Condition="'$(TargetsNetFx)' == 'true'">$(NetFxTargets)</TargetFrameworks>
      </PropertyGroup>
    </When>
    <!-- Otherwise, use all default targets. -->
    <Otherwise>
      <PropertyGroup>
        <TargetFrameworks>$(NetFxTargets);$(NetTargets)</TargetFrameworks>
      </PropertyGroup>
    </Otherwise>
  </Choose>

</Project>
